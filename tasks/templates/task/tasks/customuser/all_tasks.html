{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block content %}
<div id="content-main">
    <div class="module">
        <h1>All Tasks Overview</h1>
        
        <div class="filters">
            <select id="status-filter">
                <option value="">All Statuses</option>
                <option value="Pending">Pending</option>
                <option value="In Progress">In Progress</option>
                <option value="Completed">Completed</option>
            </select>
        </div>

        <div class="results">
            <table>
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Created By</th>
                        <th>Assigned To</th>
                        <th>Status</th>
                        <th>Due Date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for task in tasks %}
                    <tr class="task-row" data-status="{{ task.status }}">
                        <td>{{ task.title }}</td>
                        <td>{{ task.created_by.get_full_name }}</td>
                        <td>
                            {% if task.assigned_to %}
                                {{ task.assigned_to.get_full_name }}
                            {% else %}
                                <span class="text-muted">Unassigned</span>
                            {% endif %}
                        </td>
                        <td>
                            <span class="status-badge status-{{ task.status|lower }}">
                                {{ task.status }}
                            </span>
                        </td>
                        <td>{{ task.due_date|date:"M d, Y" }}</td>
                        <td class="action-buttons">
                            <a href="{% url 'admin:tasks_task_change' task.id %}" class="button">Edit</a>
                            <a href="{% url 'admin:tasks_task_delete' task.id %}" class="button delete-button">Delete</a>
                        </td>
                    </tr>
                    {% empty %}
                    <tr><td colspan="6">No tasks found.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<style>
    .filters {
        margin: 20px 0;
        padding: 15px;
        background: #f8f8f8;
        border-radius: 4px;
    }
    select {
        padding: 6px 12px;
        border: 1px solid #ccc;
        border-radius: 4px;
    }
    .button {
        display: inline-block;
        padding: 4px 8px;
        margin: 0 2px;
        background: #79aec8;
        color: white;
        text-decoration: none;
        border-radius: 4px;
    }
    .button:hover {
        background: #609ab6;
    }
    .delete-button {
        background: #ba2121;
    }
    .delete-button:hover {
        background: #a41515;
    }
    .status-badge {
        padding: 4px 8px;
        border-radius: 12px;
        font-size: 0.9em;
    }
    .status-completed {
        background: #28a745;
        color: white;
    }
    .status-in-progress {
        background: #ffc107;
        color: black;
    }
    .status-pending {
        background: #6c757d;
        color: white;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        padding: 12px 8px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    th {
        background: #f5f5f5;
    }
    tr:hover {
        background: #f8f8f8;
    }
    .text-muted {
        color: #6c757d;
    }
</style>

<script>
document.getElementById('status-filter').addEventListener('change', function() {
    var selectedStatus = this.value;
    var rows = document.getElementsByClassName('task-row');
    
    for(var row of rows) {
        if(!selectedStatus || row.dataset.status === selectedStatus) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    }
});
</script>
{% endblock %}